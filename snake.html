<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Anvil's Silly Snake Game Written in Holy C</title>
  <link rel="stylesheet" href="snake.css">
</head>
<body>


<style>
  #musicPrompt {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }
  #musicPrompt button {
    margin: 10px;
    padding: 10px 20px;
    font-size: 18px;
    background-color: #444;
    color: white;
    border: none;
    cursor: pointer;
  }
</style>

<div id="musicPrompt">
  <h2>üéµ Play with music?</h2>
  <button id="playWithMusic">Yes</button>
  <button id="playWithoutMusic">No</button>
  <button id="homeBtn" onclick="window.location.href='index.html'">Return to homepage</button>
  <style>
    #homeBtn {
      margin: 8px;
      padding: 6px 14px;
      font-size: 14px;
      background-color: #181818;
      color: #ddd;
      border: none;
      cursor: pointer;
    }
  </style>
</div>


<audio id="bgMusic" autoplay loop>
<audio id="deathSound">
  <source src="fuck-sound-effect-meme.mp3" type="audio/mpeg">
</audio>

  <source src="Strokinthatshitinbrazil_jerseyclub_200bpm_808_remix.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

  <h1>üêç Anvil's Silly Snake Game Written in Holy C</h1>
  <h3>DOESN'T WORK ON TOUCHSCREEN!!!!!</h3>
  <canvas id="game" width="400" height="400"></canvas>
  <div id="scoreBoard">
    Score: <span id="score">0</span> | High Score: <span id="highScore">0</span>
  </div>
<div id="credits" style="margin-top: 12px; font-size: 14px; color: #aaa;">Made by the Anvil System that was scolding Mista GPT everytime he made a bug that rendered the game unplayable ‚Äî works best on Opera GX</div>
  <button id="homeBtn" onclick="window.location.href='index.html'">Return to homepage</button>
  <style>
    #homeBtn {
      margin: 8px;
      padding: 6px 14px;
      font-size: 14px;
      background-color: #181818;
      color: #ddd;
      border: none;
      cursor: pointer;
    }
  </style>

  <audio id="eatSound" src=""></audio>
  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const scoreDisplay = document.getElementById("score");
    const highScoreDisplay = document.getElementById("highScore");
    const eatSound = document.getElementById("eatSound");
    const pedalSound = new Audio("jestem_pedalem.mp3");

    const gridSize = 20;
    const tileCount = canvas.width / gridSize;

    let snake = [{ x: 10, y: 10 }];
    let direction = { x: 1, y: 0 };
    let food = { x: 5, y: 5 };
    let score = 0;
    let highScore = localStorage.getItem("snakeHighScore") || 0;
    highScoreDisplay.textContent = highScore;
    let gameOver = false;
    let speed = 200;
    let gameLoopInterval;
    let paused = false;
    let easyMode = false;
    let hue = 0; // Initialize hue for rainbow effect

    function startGameLoop() {
      clearInterval(gameLoopInterval);
      gameLoopInterval = setInterval(() => {
        if (!paused) gameLoop();
      }, speed);
    }

    function gameLoop() {
      if (gameOver) return;

      const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };

      const hitsWall = head.x < 0 || head.y < 0 || head.x >= tileCount || head.y >= tileCount;
      const hitsSelf = snake.some(seg => seg.x === head.x && seg.y === head.y);

      if (hitsWall || (!easyMode && hitsSelf)) {
        playDeathSound();
gameOver = true;
        alert("Game Over! Your score: " + score);
        if (score > highScore) {
          localStorage.setItem("snakeHighScore", score);
        }
        document.location.reload();
        return;
      }

      snake.unshift(head);

      if (head.x === food.x && head.y === food.y) {
        score++;
  scoreDisplay.textContent = score;
  const music = document.getElementById("bgMusic");
  const rate = Math.min(2.5, 1 + score * 0.05);
  music.playbackRate = rate;
  speed = Math.max(50, 200 - score * 10);
  startGameLoop();
        scoreDisplay.textContent = score;
        eatSound.currentTime = 0;
        eatSound.play();
        placeFood();
        speed = Math.max(50, speed - 10);
        
document.getElementById("playWithMusic").addEventListener("click", () => {
  const music = document.getElementById("bgMusic");
  music.muted = false;
  music.play();
  document.getElementById("musicPrompt").style.display = "none";
  startGameLoop();
}, { once: true });

document.getElementById("playWithoutMusic").addEventListener("click", () => {
  const music = document.getElementById("bgMusic");
  music.muted = true;
  document.getElementById("musicPrompt").style.display = "none";
  startGameLoop();
}, { once: true });

      } else {
        snake.pop();
      }

      draw();
    }

    function draw() {
      ctx.fillStyle = "#111";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = "lime";
      for (let seg of snake) {
        ctx.fillRect(seg.x * gridSize, seg.y * gridSize, gridSize - 2, gridSize - 2);
      }

      ctx.fillStyle = "red";
      ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);
    }

    function placeFood() {
      let valid = false;
      while (!valid) {
        food.x = Math.floor(Math.random() * tileCount);
        food.y = Math.floor(Math.random() * tileCount);
        valid = !snake.some(seg => seg.x === food.x && seg.y === food.y);
      }
    }

    document.addEventListener("keydown", e => {
      switch (e.key) {
        case "ArrowUp":
          if (direction.y === 0) direction = { x: 0, y: -1 };
          break;
        case "ArrowDown":
          if (direction.y === 0) direction = { x: 0, y: 1 };
          break;
        case "ArrowLeft":
          if (direction.x === 0) direction = { x: -1, y: 0 };
          break;
        case "ArrowRight":
          if (direction.x === 0) direction = { x: 1, y: 0 };
          break;
        case "p":
        case "P":
          easyMode = !easyMode;
          if (easyMode) {
            pedalSound.play();
          } else {
            pedalSound.pause();
            pedalSound.currentTime = 0;
          }
          break;
        case " ":
          paused = !paused;
          break;
      }
    });

document.getElementById("playWithMusic").addEventListener("click", () => {
  const music = document.getElementById("bgMusic");
  music.muted = false;
  music.play();
  document.getElementById("musicPrompt").style.display = "none";
  startGameLoop();
}, { once: true });

document.getElementById("playWithoutMusic").addEventListener("click", () => {
  const music = document.getElementById("bgMusic");
  music.muted = true;
  document.getElementById("musicPrompt").style.display = "none";
  startGameLoop();
}, { once: true });

  </script>

<script>
const audioElement = document.getElementById('bgMusic');
const audioContext = new (window.AudioContext || window.webkitAudioContext)();
const track = audioContext.createMediaElementSource(audioElement);
const gainNode = audioContext.createGain();
track.connect(gainNode).connect(audioContext.destination);

audioElement.preservesPitch = false;
audioElement.mozPreservesPitch = false;
audioElement.webkitPreservesPitch = false;

function setPlaybackRate(rate) {
  audioElement.playbackRate = rate;
}
</script>


<script>
const deathSound = document.getElementById("deathSound");
function playDeathSound() {
  deathSound.currentTime = 0;
  deathSound.play();
}
</script>


<script>
const bgMusic = document.getElementById("bgMusic");
bgMusic.preservesPitch = false;
bgMusic.mozPreservesPitch = false;
bgMusic.webkitPreservesPitch = false;

let rate = 3.0;
bgMusic.playbackRate = rate;

const tempoInterval = setInterval(() => {
  if (rate > 1.0) {
    rate -= 0.05;
    bgMusic.playbackRate = rate;
  } else {
    bgMusic.playbackRate = 1.0;
    clearInterval(tempoInterval);
  }
}, 500);
</script>

</body>
</html>
